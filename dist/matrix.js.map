{"version":3,"sources":["matrix.js"],"names":["Matrix","matrix","Array","push","previousDomains","addDomain","activeDomain","object","domainIndex","getDomainIndex","getActiveDomain","map","domain","index","newDomain","objectIndex","getObjectIndex","permissions","previousDomainIndex","length","previousDomainPermissions","split","filter","x","n","s","indexOf","join","retIndex","item","pop","username","console","log"],"mappings":"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","file":"matrix.js","sourcesContent":["export default class Matrix {\n\t\n\tconstructor() {\n\n\t\tthis.matrix = new Array();\n\t\tthis.matrix.push(new Array());\n\t\tthis.previousDomains = new Array();\n\t\tthis.addDomain('admin');\n\t\tthis.activeDomain = 'admin';\n\t}\n\n\taddObject(object) {\n\n\t\tlet domainIndex = this.getDomainIndex(this.getActiveDomain());\n\n\t\tthis.matrix[0].push(object);\n\n\t\tthis.matrix.map((domain, index) => {\n\t\t\tif (index > 0) {\n\t\t\t\tif(index === domainIndex || domain[0] === 'admin')\n\t\t\t\t\tdomain.push('rwx');\n\t\t\t\telse\n\t\t\t\t\tdomain.push('-');\n\t\t\t}\n\t\t});\n\t}\n\n\taddDomain(domain) {\n\n\t\tlet newDomain = new Array();\n\n\t\tnewDomain.push(domain);\n\t\tthis.matrix[0].map(() => newDomain.push('-'));\n\t\tthis.matrix.push(newDomain);\n\t}\n\n\tgetDomainPermissionsForObject(object) {\n\n\t\tconst domainIndex = this.getDomainIndex(this.getActiveDomain());\n\t\tconst objectIndex = this.getObjectIndex(object);\n\t\tlet permissions = this.matrix[domainIndex][objectIndex+1];\n\t\tlet previousDomainIndex = this.getDomainIndex(this.previousDomains[this.previousDomains.length-1]);\n\t\tlet previousDomainPermissions = this.matrix[previousDomainIndex][objectIndex+1];\n\n\t\tif (previousDomainPermissions) {\n\t\t\tpermissions += previousDomainPermissions;\n\t\t}\n\n\t\tpermissions.split(\"\").filter(function(x, n, s) { return s.indexOf(x) == n }).join(\"\");\n\n\t\treturn permissions;\n\t}\n\n\tgetDomainIndex(domain) {\n\n\t\tlet retIndex = -1;\n\n\t\tthis.matrix.map((item, index) => {\n\t\t\tif (item[0] == domain)\n\t\t\t\tretIndex = index;\n\t\t});\n\n\t\treturn retIndex;\n\t}\n\n\tgetObjectIndex(object) {\n\n\t\tlet retIndex = -1;\n\n\t\tthis.matrix[0].map((item, index) => {\n\t\t\tif (item == object) {\n\t\t\t\tretIndex = index;\n\t\t\t}\n\t\t});\n\n\t\treturn retIndex;\n\t}\n\t\n\tsetActiveDomain(domain) {\n\t\tthis.activeDomain = domain;\n\t}\n\n\tgetActiveDomain() {\n\t\treturn this.activeDomain;\n\t}\n\n\tswitchDomain(domain) {\n\t\tif (this.previousDomains[this.previousDomains.length-1] === domain)\n\t\t\tthis.previousDomains.pop();\n\t\telse\n\t\t\tthis.previousDomains.push(this.getActiveDomain());\n\t\tthis.activeDomain = domain;\n\t}\n\n\tgrantPermission(username, object, permissions) {\n\t\tlet objectIndex = this.getObjectIndex(object);\n\t\tlet domainIndex = this.getDomainIndex(username);\n\t\tthis.matrix[domainIndex][objectIndex+1] = permissions;\n\t}\n\n\tprintMatrix() {\n\t\tconsole.log(this.matrix);\n\t}\n}\n"]}